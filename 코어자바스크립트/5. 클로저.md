# í´ë¡œì € (Closure)

## 1. í´ë¡œì €ë€?

> í´ë¡œì €ëŠ” **í•¨ìˆ˜ì™€ ê·¸ í•¨ìˆ˜ê°€ ì„ ì–¸ë  ë‹¹ì‹œì˜ ë ‰ì‹œì»¬ í™˜ê²½(Lexical Environment)ê³¼ì˜ ì¡°í•©**ì´ë‹¤.
> 

ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í•¨ìˆ˜ëŠ” ì„ ì–¸ë  ë•Œ **ìì‹ ì´ ì •ì˜ëœ í™˜ê²½ì„ ê¸°ì–µ**í•œë‹¤.

ì´ í™˜ê²½ì—ëŠ” ë‹¤ìŒì´ í¬í•¨ëœë‹¤.

- ìì‹ ì˜ ìŠ¤ì½”í”„ ë³€ìˆ˜
- ìƒìœ„ ìŠ¤ì½”í”„ ë³€ìˆ˜
- ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì˜ `outerEnvironmentReference`

ì¦‰, **í•¨ìˆ˜ëŠ” ìì‹ ì´ íƒœì–´ë‚œ í™˜ê²½ì„ ê¸°ì–µí•œ ì±„ë¡œ ì‚´ì•„ìˆëŠ” ê°ì²´**ë‹¤.

---

## 2. ê¸°ë³¸ ì˜ˆì œ

```jsx
var outer = function() {
  var a = 1;
  var inner = function() {
    console.log(++a);
  };
  inner();
};
outer();
```

### ë™ì‘ ê³¼ì •

- `inner` í•¨ìˆ˜ ë‚´ë¶€ì—ëŠ” `a`ê°€ ì—†ìŒ
- ë”°ë¼ì„œ ìƒìœ„ ìŠ¤ì½”í”„ì¸ `outer`ì˜ ë ‰ì‹œì»¬ í™˜ê²½ì—ì„œ `a`ë¥¼ ì°¾ìŒ
- `outer` ì‹¤í–‰ ì¢…ë£Œ í›„ ë” ì´ìƒ ì°¸ì¡°ê°€ ì—†ìœ¼ë¯€ë¡œ GC ëŒ€ìƒì´ ë¨

ğŸ‘‰ ì´ ì˜ˆì œëŠ” í´ë¡œì €ê°€ â€œìƒê¸°ê¸´ í•˜ì§€ë§Œ ìœ ì§€ë˜ì§€ëŠ” ì•ŠëŠ” ê²½ìš°â€

---

## 3. í´ë¡œì €ê°€ ìœ ì§€ë˜ëŠ” ì˜ˆì œ

```jsx
var outer = function() {
  var a = 1;
  var inner = function() {
    console.log(++a);
  };
  return inner;
};

var outer2 = outer();

console.log(outer2()); // 2
console.log(outer2()); // 3
```

### ì‹¤í–‰ íë¦„

1. ì „ì—­ ì»¨í…ìŠ¤íŠ¸ì— `outer` ë“±ë¡
2. `outer()` ì‹¤í–‰
3. `inner` ë°˜í™˜
4. `outer` ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ëŠ” ì¢…ë£Œë˜ì§€ë§Œ,
5. `inner`ê°€ `a`ë¥¼ ì°¸ì¡°í•˜ê³  ìˆìœ¼ë¯€ë¡œ `a`ëŠ” GC ëŒ€ìƒì´ ë˜ì§€ ì•ŠìŒ

ğŸ‘‰ ì™¸ë¶€ í•¨ìˆ˜ì˜ ì‹¤í–‰ì´ ëë‚¬ìŒì—ë„ ë‚´ë¶€ í•¨ìˆ˜ê°€ ìƒìœ„ ë³€ìˆ˜ì— ì ‘ê·¼ ê°€ëŠ¥

ğŸ‘‰ ì´ê²ƒì´ ì§„ì§œ í´ë¡œì €

---

## 4. í´ë¡œì €ì˜ ì •ì˜ ì •ë¦¬

**ì–´ë–¤ í•¨ìˆ˜ Aì˜ ì§€ì—­ ë³€ìˆ˜ aë¥¼ ì°¸ì¡°í•˜ëŠ” ë‚´ë¶€ í•¨ìˆ˜ Bê°€ ì™¸ë¶€ë¡œ ì „ë‹¬ë  ê²½ìš°,Aì˜ ì‹¤í–‰ì´ ì¢…ë£Œëœ ì´í›„ì—ë„ ë³€ìˆ˜ aê°€ ì‚¬ë¼ì§€ì§€ ì•ŠëŠ” í˜„ìƒ**

---

# 5. í´ë¡œì €ì™€ ë©”ëª¨ë¦¬ ê´€ë¦¬

í´ë¡œì €ëŠ” ì˜ë„ì ìœ¼ë¡œ ë©”ëª¨ë¦¬ë¥¼ ìœ ì§€í•˜ëŠ” êµ¬ì¡°ë‹¤.

### âŒ ì˜ëª»ëœ ì˜¤í•´

- í´ë¡œì € = ë©”ëª¨ë¦¬ ëˆ„ìˆ˜

### âœ… ì •í™•í•œ ì´í•´

- ì°¸ì¡°ê°€ ìœ ì§€ë˜ë©´ GC ëŒ€ìƒì´ ì•„ë‹ˆë‹¤.
- ì˜ë„ì  ìœ ì§€ë¼ë©´ ëˆ„ìˆ˜ê°€ ì•„ë‹ˆë‹¤.
- ì˜ë„í•˜ì§€ ì•Šì€ ì°¸ì¡° ìœ ì§€ê°€ ë¬¸ì œë‹¤.

---

## ë©”ëª¨ë¦¬ í•´ì œ ë°©ë²•

```jsx
var outer = (function () {
  var a = 1;
  var inner = function () {
    return ++a;
  };
  return inner;
})();

console.log(outer());
console.log(outer());

outer = null; // ì°¸ì¡° ì œê±°
```

âœ” ì°¸ì¡°ë¥¼ ëŠìœ¼ë©´ GC ëŒ€ìƒì´ ëœë‹¤.

---

# 6. í´ë¡œì € í™œìš© ì‚¬ë¡€

---

## 6-1. ì½œë°± í•¨ìˆ˜ì—ì„œ ì™¸ë¶€ ë°ì´í„° ìœ ì§€

```jsx
var fruits = ['apple','banana','peach'];
var $ul = document.createElement('ul');

fruits.forEach(function (fruit) {
  var $li = document.createElement('li');
  $li.innerText = fruit;
  $li.addEventListener('click', function() {
    alert('your choice is ' + fruit);
  });
  $ul.appendChild($li);
});
document.body.appendChild($ul);
```

### ë¶„ì„

- `forEach` ì½œë°±ì€ í´ë¡œì €ê°€ ì•„ë‹˜
- `addEventListener`ì˜ ì½œë°±ì€ `fruit`ì„ ì°¸ì¡°
- ë”°ë¼ì„œ í´ë¡œì € ë°œìƒ

---

## 6-2. ë¦¬íŒ©í† ë§ ë°©ë²• ì •ë¦¬

### 1ï¸âƒ£ ì™¸ë¶€ í•¨ìˆ˜ë¡œ ë¶„ë¦¬ (ë¬¸ì œì  ì¡´ì¬)

```jsx
function alertFruit(fruit) {
  alert('your choice is ' + fruit);
}
```

ë¬¸ì œ:

- `addEventListener`ëŠ” ì´ë²¤íŠ¸ ê°ì²´ë¥¼ ë„˜ê¸´ë‹¤
- ì§ì ‘ ë§¤ê°œë³€ìˆ˜ë¥¼ ì „ë‹¬í•˜ê¸° ì–´ë µë‹¤

---

### 2ï¸âƒ£ bind ì‚¬ìš©

```jsx
$li.addEventListener('click', alertFruit.bind(null, fruit));
```

- ëª…ì‹œì  ë°”ì¸ë”©
- í•˜ì§€ë§Œ ì½”ë“œ ê°€ë…ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆìŒ

---

### 3ï¸âƒ£ ê³ ì°¨ í•¨ìˆ˜ í™œìš© (ê¶Œì¥)

```jsx
var alertFruitBuilder = function (fruit) {
  return function() {
    alert('your choice is ' + fruit);
  };
};

$li.addEventListener('click', alertFruitBuilder(fruit));
```

âœ” í´ë¡œì €ë¥¼ ì ê·¹ í™œìš©

âœ” ê°€ë…ì„± ì¢‹ìŒ

âœ” ëª…í™•í•œ ì˜ë„ í‘œí˜„

---

# 7. ì ‘ê·¼ ê¶Œí•œ ì œì–´ (Private êµ¬í˜„)

ìë°”ìŠ¤í¬ë¦½íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ publicì´ë‹¤.

í•˜ì§€ë§Œ í´ë¡œì €ë¥¼ í™œìš©í•˜ë©´ private êµ¬í˜„ì´ ê°€ëŠ¥í•˜ë‹¤.

```jsx
function Counter() {
  var count = 0; // private

  return {
    increase: function() {
      return ++count;
    },
    decrease: function() {
      return --count;
    }
  };
}

var counter = Counter();
console.log(counter.increase());
console.log(counter.count); // undefined
```

âœ” `count`ëŠ” ì™¸ë¶€ì—ì„œ ì ‘ê·¼ ë¶ˆê°€

âœ” í´ë¡œì €ë¡œ ì€ë‹‰ ì„±ê³µ

---

# 8. ë¶€ë¶„ ì ìš© í•¨ìˆ˜ (Partial Application)

ì¼ë¶€ ì¸ìë¥¼ ë¯¸ë¦¬ ê³ ì •í•˜ëŠ” ê¸°ë²•

## ë””ë°”ìš´ìŠ¤ ì˜ˆì œ

```jsx
function debounce(func, delay) {
  var timer = null;

  return function() {
    var context = this;
    var args = arguments;

    clearTimeout(timer);

    timer = setTimeout(function() {
      func.apply(context, args);
    }, delay);
  };
}
```

âœ” `timer`ëŠ” í´ë¡œì €ë¡œ ìœ ì§€ë¨

âœ” ì—°ì† í˜¸ì¶œ ì‹œ ë§ˆì§€ë§‰ë§Œ ì‹¤í–‰

---

# 9. ì»¤ë§ (Currying)

ì—¬ëŸ¬ ì¸ìë¥¼ ë°›ëŠ” í•¨ìˆ˜ë¥¼

ğŸ‘‰ í•˜ë‚˜ì˜ ì¸ìë§Œ ë°›ëŠ” í•¨ìˆ˜ë¡œ ë‚˜ëˆ  ì²´ì¸ í˜•íƒœë¡œ êµ¬ì„±

```jsx
function curryAdd(a) {
  return function(b) {
    return function(c) {
      return a + b + c;
    };
  };
}

curryAdd(1)(2)(3); // 6
```

âœ” ì¸ìë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ì ìš©

âœ” í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° í•µì‹¬ íŒ¨í„´